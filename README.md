# Creepy Companion

A browser-based horror pet simulator that inverts traditional virtual pet mechanics through uncertainty, decay, and AI-generated narrative horror.

## Features

- **Real-time Evolution**: Watch your pet transform from EGG → BABY → TEEN → ABOMINATION
- **Mystery Feeding**: Scavenge for AI-generated offerings with hidden effects
- **Persistent State**: Your pet continues to exist (and decay) even when offline
- **Dynamic Narrative**: AI-generated horror descriptions create unique experiences

## Tech Stack

- **Frontend**: React 19 + TypeScript + Vite + PixiJS 8
- **State**: Zustand with localStorage persistence
- **Backend**: Vercel Serverless Functions
- **AI**: Featherless AI (Llama 3.1-8B-Instruct) via Vercel AI SDK
- **Testing**: Vitest + Testing Library + fast-check

## Development

### Prerequisites

- Node.js 18+ and npm
- Featherless AI API key (get one at https://featherless.ai)

### Setup

1. Clone the repository
2. Install dependencies:

   ```bash
   npm install
   ```

3. Create a `.env` file from the example:

   ```bash
   cp .env.example .env
   ```

4. Add your Featherless API key to `.env`:
   ```
   FEATHERLESS_API_KEY=your_api_key_here
   ```

### Running Locally

```bash
# Start development server
npm run dev

# Run tests
npm test

# Run tests in watch mode
npm run test:watch

# Open Vitest UI
npm run test:ui

# Lint code
npm run lint

# Build for production
npm run build

# Preview production build
npm run preview
```

## Deployment to Vercel

### Quick Deploy

[![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https://github.com/yourusername/creepy-companion)

### Manual Deployment

1. **Install Vercel CLI** (optional):

   ```bash
   npm install -g vercel
   ```

2. **Connect to Vercel**:

   ```bash
   vercel login
   ```

3. **Deploy**:

   ```bash
   vercel
   ```

4. **Set Environment Variables** in Vercel Dashboard:

   - Go to your project settings
   - Navigate to "Environment Variables"
   - Add `FEATHERLESS_API_KEY` with your API key
   - Make sure it's available for Production, Preview, and Development environments

5. **Deploy to Production**:
   ```bash
   vercel --prod
   ```

### Environment Variables

The following environment variable must be set in your Vercel project:

| Variable              | Description                        | Required |
| --------------------- | ---------------------------------- | -------- |
| `FEATHERLESS_API_KEY` | API key for Featherless AI service | Yes      |

### Vercel Configuration

The project includes a `vercel.json` configuration file that:

- Sets build command to `npm run build`
- Configures output directory as `dist`
- Specifies Vite as the framework
- Configures the `/api/chat` serverless function with:
  - 30-second maximum duration
  - 1024MB memory allocation
- Sets up CORS headers for API endpoints

### Testing Deployment

After deployment, test the serverless function:

```bash
curl -X POST https://your-app.vercel.app/api/chat \
  -H "Content-Type: application/json" \
  -d '{"prompt": "Describe a mysterious artifact in one sentence"}'
```

Expected response:

```json
{
  "text": "A cryptic description generated by AI..."
}
```

## Project Structure

```
/
├── api/                    # Vercel serverless functions
│   ├── chat.ts            # AI text generation proxy
│   └── README.md          # API documentation
├── src/                   # Frontend source code
│   ├── components/        # React components
│   ├── test/              # Test configuration
│   ├── store.ts           # Zustand state management
│   ├── types.ts           # TypeScript definitions
│   └── aiClient.ts        # AI API client
├── .kiro/                 # Kiro IDE configuration
│   ├── steering/          # Development guidelines
│   └── specs/             # Feature specifications
└── vercel.json            # Vercel deployment config
```

## Game Mechanics

- **Time System**: 1 real second = 1 game minute
- **Stat Decay**: Hunger increases 0.05/min, Sanity decreases 0.02/min
- **Evolution**: Age-based (5 min, 24 hrs) and corruption-based (>80)
- **Feeding**: PURITY items restore sanity, ROT items increase corruption
- **Daily Limit**: Feeding more than 3 times per game day causes vomit event

## Documentation

- [API Documentation](api/README.md)
- [Accessibility Guidelines](ACCESSIBILITY.md)
- [Feature Specifications](.kiro/specs/creepy-companion/)

## License

MIT
